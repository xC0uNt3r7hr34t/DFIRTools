#!/bin/bash
 
log_file="$@" # get filename from input
if [ -f "$log_file" ]
  then
  # Extract IP addresses from the log file
  timestamps=($(grep -oP ' \K\d{2}\/\d{2}\/\d{4}:\d{2}:\d{2}:\d{2}' "$log_file"))
  client_ips=($(grep -oP 'Client_ip \K[^ ]+' "$log_file"))
  nat_ips=($(grep -oP 'Nat_ip \K[^ "]+' "$log_file"))
  source_ips=($(grep -oP 'Source \K[^:-]+' "$log_file"))
  # Compare the IP addresses
  for ((i=0; i<${#client_ips[@]}; i++))
  do
    timestamp="${timestamps[$i]}"
    client_ip="${client_ips[$i]}"
    nat_ip="${nat_ips[$i]}"
    source_ip="${source_ips[$i]}"
    if [ "$client_ip" != "$source_ip" ]; then
      echo "Mismatch detected:  Timestamp: $timestamp, Client_ip: $client_ip, Nat_ip: $nat_ip, Source: $source_ip"
    fi
  done
else
  echo "File not specified or does not exist. Please specify a file as an argument."
fi
